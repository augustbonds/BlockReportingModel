<map version="freeplane 1.3.0">
<!--To view this file, download free mind mapping software Freeplane from http://freeplane.sourceforge.net -->
<node TEXT="Execution paths that alter namenode state (replicas)" ID="ID_1723255651" CREATED="1283093380553" MODIFIED="1499848016749"><hook NAME="MapStyle">

<map_styles>
<stylenode LOCALIZED_TEXT="styles.root_node">
<stylenode LOCALIZED_TEXT="styles.predefined" POSITION="right">
<stylenode LOCALIZED_TEXT="default" MAX_WIDTH="600" COLOR="#000000" STYLE="as_parent">
<font NAME="SansSerif" SIZE="10" BOLD="false" ITALIC="false"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.details"/>
<stylenode LOCALIZED_TEXT="defaultstyle.note"/>
<stylenode LOCALIZED_TEXT="defaultstyle.floating">
<edge STYLE="hide_edge"/>
<cloud COLOR="#f0f0f0" SHAPE="ROUND_RECT"/>
</stylenode>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.user-defined" POSITION="right">
<stylenode LOCALIZED_TEXT="styles.topic" COLOR="#18898b" STYLE="fork">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subtopic" COLOR="#cc3300" STYLE="fork">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subsubtopic" COLOR="#669900">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.important">
<icon BUILTIN="yes"/>
</stylenode>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.AutomaticLayout" POSITION="right">
<stylenode LOCALIZED_TEXT="AutomaticLayout.level.root" COLOR="#000000">
<font SIZE="18"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,1" COLOR="#0033ff">
<font SIZE="16"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,2" COLOR="#00b439">
<font SIZE="14"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,3" COLOR="#990000">
<font SIZE="12"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,4" COLOR="#111111">
<font SIZE="10"/>
</stylenode>
</stylenode>
</stylenode>
</map_styles>
</hook>
<hook NAME="AutomaticEdgeColor" COUNTER="3"/>
<node TEXT="addExpectedReplica" POSITION="left" ID="ID_1039148266" CREATED="1496820898317" MODIFIED="1496820930812">
<edge COLOR="#00ffff"/>
<node TEXT="setExpectedLocations" ID="ID_1124580691" CREATED="1496817173148" MODIFIED="1496820907399">
<node TEXT="convertToBlockUnderConstruction" ID="ID_1229759813" CREATED="1496817475729" MODIFIED="1496819914605">
<font BOLD="false"/>
<node TEXT="setLastBlock" ID="ID_596834858" CREATED="1496818225779" MODIFIED="1496818228352">
<node TEXT="commitBlockSynchronization" ID="ID_1086073246" CREATED="1496818254555" MODIFIED="1496818268383">
<node TEXT="dn.commitBlockSynchronization" ID="ID_798335840" CREATED="1496818269147" MODIFIED="1496818282306">
<font BOLD="true"/>
</node>
</node>
<node TEXT="convertLastBlockToUnderConstruction" ID="ID_1434885616" CREATED="1496818307050" MODIFIED="1496818318679">
<node TEXT="prepareFileForWrite" ID="ID_40701374" CREATED="1496818319138" MODIFIED="1496818322791">
<node TEXT="startFileInternal" ID="ID_778808751" CREATED="1496818331210" MODIFIED="1496818361810">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="BlockInfoUnderConstruction" ID="ID_532916258" CREATED="1496817491449" MODIFIED="1496817499078">
<node TEXT="convertToBlockUnderConstruction" ID="ID_1361053186" CREATED="1496818088628" MODIFIED="1496818369938">
<font BOLD="true"/>
</node>
<node TEXT="FSDirectory.addBlock" ID="ID_410240150" CREATED="1496818102847" MODIFIED="1496819923773">
<font BOLD="false"/>
<node TEXT="saveAllocatedBlock" ID="ID_969914706" CREATED="1496818134020" MODIFIED="1496818146200">
<node TEXT="getAdditionalBlock" ID="ID_1776974404" CREATED="1496818146628" MODIFIED="1496818150640">
<node TEXT="client.addBlock" ID="ID_639069400" CREATED="1496818156764" MODIFIED="1496818164627">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="internalReleaseLease" ID="ID_1100962964" CREATED="1496817510393" MODIFIED="1496817514542">
<node TEXT="checkLeases" ID="ID_1783300385" CREATED="1496817645624" MODIFIED="1496817649429">
<node TEXT="LeaseManager.Monitor.run" ID="ID_668120338" CREATED="1496818014653" MODIFIED="1496818026549">
<font BOLD="true"/>
</node>
</node>
<node TEXT="recoverLeaseInternal (x2)" ID="ID_148196628" CREATED="1496817656736" MODIFIED="1496817689740">
<node TEXT="startFileInternal" ID="ID_1416281870" CREATED="1496817708175" MODIFIED="1496819909871">
<font BOLD="false"/>
<node TEXT="appendFileInt" ID="ID_1112512173" CREATED="1496817768607" MODIFIED="1496817771403">
<node TEXT="appendFile" ID="ID_893702321" CREATED="1496817781287" MODIFIED="1496817783107">
<node TEXT="client.append" ID="ID_224260362" CREATED="1496817788359" MODIFIED="1496826782234">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="startFileInt" ID="ID_1289535838" CREATED="1496817827704" MODIFIED="1496817830811">
<node TEXT="startFile" ID="ID_818541736" CREATED="1496817837350" MODIFIED="1496817846822">
<node TEXT="client.create" ID="ID_785763969" CREATED="1496817846825" MODIFIED="1496817856854">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="recoverLease" ID="ID_828732548" CREATED="1496817720943" MODIFIED="1496817731150">
<node TEXT="client.recoverLease (ONLY TESTS)" ID="ID_473712109" CREATED="1496817732815" MODIFIED="1496822627167">
<font BOLD="false"/>
</node>
</node>
</node>
</node>
<node TEXT="updatePipelineInternal" ID="ID_1451224848" CREATED="1496817521665" MODIFIED="1496817526166">
<node TEXT="updatePipeline" ID="ID_392214470" CREATED="1496817539321" MODIFIED="1496817554737">
<node TEXT="client.updatePipeline" ID="ID_1139874007" CREATED="1496817554740" MODIFIED="1496817613600">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="addReplicaIfNotPresent" ID="ID_288703724" CREATED="1496817186596" MODIFIED="1496820917407">
<node TEXT="addStoredBlockUnderConstruction" ID="ID_733926113" CREATED="1496817275227" MODIFIED="1496817291779">
<node TEXT="processAndHandleReportedBlock" ID="ID_1256409353" CREATED="1496817291781" MODIFIED="1496819998844">
<font BOLD="false"/>
<node TEXT="addBlock" ID="ID_160638675" CREATED="1496819947565" MODIFIED="1496819949954">
<node TEXT="processIncrementalBlockReport" ID="ID_531057022" CREATED="1496819974309" MODIFIED="1496819995764">
<font BOLD="true"/>
</node>
</node>
<node TEXT="processIncrementalBlockReport" ID="ID_172938924" CREATED="1496819950533" MODIFIED="1496819972641">
<node TEXT="dn.blockReceivedDeleted" ID="ID_582727805" CREATED="1496819988053" MODIFIED="1496819994501">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="addStoredBlockUnderConstructionTx" ID="ID_189391014" CREATED="1496817309775" MODIFIED="1496817323587">
<node TEXT="processFullReport" ID="ID_1847781298" CREATED="1496817323591" MODIFIED="1496820044012">
<font BOLD="false"/>
<node TEXT="processReport" ID="ID_1977929007" CREATED="1496820014476" MODIFIED="1496820016720">
<node TEXT="dn.blockReport" ID="ID_1088687757" CREATED="1496820030436" MODIFIED="1496820043228">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="&quot;deleteExpectedReplica&quot;" POSITION="left" ID="ID_1879491075" CREATED="1496820976837" MODIFIED="1496820986058">
<edge COLOR="#00007c"/>
<node TEXT="complete" ID="ID_1403215987" CREATED="1496818740151" MODIFIED="1496820991096">
<node TEXT="convertToCompleteBlock" ID="ID_236823094" CREATED="1496818749495" MODIFIED="1496818752787">
<node TEXT="completeBlock" ID="ID_878101264" CREATED="1496818760535" MODIFIED="1496818762667">
<node TEXT="commitOrCompleteLastBlock" ID="ID_1475628739" CREATED="1496818948621" MODIFIED="1496818953745">
<node TEXT="FSNamesystem.commitOrCompleteLastBlock" ID="ID_1649623882" CREATED="1496819443753" MODIFIED="1496819455517">
<node TEXT="getAdditionalBlock" ID="ID_14595206" CREATED="1496819460857" MODIFIED="1496819470557">
<node TEXT="client.addBlock" ID="ID_1635530938" CREATED="1496819625112" MODIFIED="1496819629647">
<font BOLD="true"/>
</node>
</node>
<node TEXT="completeFileInternal" ID="ID_1467698882" CREATED="1496819472537" MODIFIED="1496819486725">
<node TEXT="completeFile" ID="ID_198405411" CREATED="1496819560112" MODIFIED="1496819563261">
<node TEXT="client.complete" ID="ID_1339201722" CREATED="1496819576256" MODIFIED="1496819606320">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="commitBlockSynchronization" ID="ID_1904670664" CREATED="1496819530314" MODIFIED="1496819534725">
<node TEXT="dn.commitBlockSynchronization" ID="ID_178215588" CREATED="1496819539064" MODIFIED="1496819546160">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="completeBlock" ID="ID_1021735568" CREATED="1496818967502" MODIFIED="1496818969889">
<node TEXT="addStoredBlock" ID="ID_1266167639" CREATED="1496818976781" MODIFIED="1496818979033">
<node TEXT="addStoredBlockUnderConstruction" ID="ID_1936892975" CREATED="1496818984949" MODIFIED="1496818990185">
<node TEXT="processAndHandleReportedBlock" ID="ID_1944467507" CREATED="1496818996925" MODIFIED="1496819830094">
<font BOLD="true"/>
</node>
<node TEXT="addStoredBlockUnderConstructionTx" ID="ID_973121362" CREATED="1496819301170" MODIFIED="1496819309495">
<node TEXT="processFullReport" ID="ID_1047000167" CREATED="1496819348466" MODIFIED="1496819356578">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="processAndHandleReportedBlock" ID="ID_1341889084" CREATED="1496818999949" MODIFIED="1496819819254">
<font BOLD="false"/>
<node TEXT="processIncrementalBlockReport" ID="ID_1600618858" CREATED="1496819196203" MODIFIED="1496819386113">
<font BOLD="true"/>
</node>
<node TEXT="addBlock" ID="ID_1611167793" CREATED="1496819230107" MODIFIED="1496819232103">
<node TEXT="processIncrementalBlockReport" ID="ID_1173470945" CREATED="1496819232875" MODIFIED="1496819385369">
<font BOLD="false"/>
<node TEXT="dn.blockReceivedAndDeleted" ID="ID_331275000" CREATED="1496819387666" MODIFIED="1496819394169">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="addStoredBlockTx" ID="ID_1513364004" CREATED="1496819032630" MODIFIED="1496819035609">
<node TEXT="processFullReport" ID="ID_1477454914" CREATED="1496819040500" MODIFIED="1496819357513">
<font BOLD="true"/>
<node TEXT="processReport" ID="ID_966190374" CREATED="1496819262691" MODIFIED="1496819265982">
<node TEXT="dn.blockReport" ID="ID_1367982429" CREATED="1496819276674" MODIFIED="1496819280066">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="tryToCompleteBlock" ID="ID_226759237" CREATED="1496818774175" MODIFIED="1496818777523">
<node TEXT="checkFileProgress x2" ID="ID_1957961484" CREATED="1496818785126" MODIFIED="1496818805643">
<node TEXT="analyzeFileState" ID="ID_989357735" CREATED="1496818814182" MODIFIED="1496818817043">
<node TEXT="getAdditionalBlock (x2)" ID="ID_1216532051" CREATED="1496818880678" MODIFIED="1496818906754">
<node TEXT="client.addBlock" ID="ID_1909581205" CREATED="1496818912701" MODIFIED="1496818919013">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="completeFileInternal" ID="ID_1440049702" CREATED="1496818829830" MODIFIED="1496818834603">
<node TEXT="completeFile" ID="ID_672339439" CREATED="1496818840710" MODIFIED="1496818843026">
<node TEXT="client.complete" ID="ID_153278422" CREATED="1496818851830" MODIFIED="1496818857310">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="clientProtocol" POSITION="right" ID="ID_385957382" CREATED="1496821256499" MODIFIED="1496821269488">
<edge COLOR="#7c007c"/>
<node TEXT="client.updatePipeline" ID="ID_296287143" CREATED="1496820940469" MODIFIED="1496821260901">
<node TEXT="DFSClient.updatePipeline" ID="ID_1981897851" CREATED="1496820619543" MODIFIED="1496820955646">
<node TEXT="setupPipelineForAppendOrRecovery" ID="ID_226878560" CREATED="1496820639591" MODIFIED="1496820648019">
<node TEXT="DataStreamer.run (PIPELINE_SETUP_APPEND)" ID="ID_1789259510" CREATED="1496820660895" MODIFIED="1496824839962">
<font BOLD="true"/>
</node>
<node TEXT="processDatanodeError" ID="ID_468542503" CREATED="1496820683464" MODIFIED="1496820702596">
<node TEXT="DataStreamer.run (IOException)" ID="ID_761371544" CREATED="1496820703943" MODIFIED="1496825121811">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="client.addBlock" ID="ID_1282089337" CREATED="1496821245563" MODIFIED="1496821262917">
<node TEXT="DFSClient.addBlock" ID="ID_567201450" CREATED="1496821398209" MODIFIED="1496821404598">
<node TEXT="locateFollowingBlock" ID="ID_221638360" CREATED="1496821412441" MODIFIED="1496821415806">
<node TEXT="nextBlockOutputStream" ID="ID_1599906724" CREATED="1496821441849" MODIFIED="1496821446877">
<node TEXT="DataStreamer.run (PIPELINE_SETUP_CREATE)" ID="ID_1745172630" CREATED="1496821457065" MODIFIED="1496824982593">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="client.complete" ID="ID_781887611" CREATED="1496821699244" MODIFIED="1496821704692">
<node TEXT="DFSClient.complete" ID="ID_783520988" CREATED="1496821705935" MODIFIED="1496821709620">
<node TEXT="DFSOutputStream.completeFile" ID="ID_366249883" CREATED="1496821710767" MODIFIED="1496821754259">
<node TEXT="DFSOutputStream.close" ID="ID_1812638364" CREATED="1496821772118" MODIFIED="1496821779286">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="client.recoverLease" ID="ID_1161843099" CREATED="1496822500776" MODIFIED="1496822508404">
<node TEXT="DFSClient.recoverLease" ID="ID_63686692" CREATED="1496822528672" MODIFIED="1496822540009">
<node TEXT="DistributedFileSystem.recoverLease" ID="ID_558989532" CREATED="1496822551840" MODIFIED="1496822592646">
<node TEXT="ONLY TESTS" ID="ID_1699043976" CREATED="1496822601568" MODIFIED="1496822606284"/>
</node>
</node>
</node>
<node TEXT="client.create" ID="ID_221813432" CREATED="1496823440825" MODIFIED="1496823443157">
<node TEXT="DFSClient.create" ID="ID_1626116284" CREATED="1496826555392" MODIFIED="1496826560579">
<node TEXT="DFSOutputStream()" ID="ID_764542210" CREATED="1496826567207" MODIFIED="1496826578060">
<node TEXT="newStreamForCreate" ID="ID_1040658075" CREATED="1496826585295" MODIFIED="1496826589107">
<node TEXT="DFSClient.create" ID="ID_45612516" CREATED="1496826693310" MODIFIED="1496826700302">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="client.append" ID="ID_524389151" CREATED="1496823443856" MODIFIED="1496826789394">
<node TEXT="DFSClient.callAppend" ID="ID_213829227" CREATED="1496826799549" MODIFIED="1496826813505">
<node TEXT="DFSClient.append" ID="ID_1017677021" CREATED="1496826840221" MODIFIED="1496826860149">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="datanodeProtocol" POSITION="right" ID="ID_319388478" CREATED="1496821275971" MODIFIED="1496821279144">
<edge COLOR="#007c7c"/>
<node TEXT="dn.blockReceivedAndDeleted" ID="ID_292947274" CREATED="1496821529664" MODIFIED="1496821539780">
<node TEXT="blockReceviedAndDeleted" ID="ID_1120014402" CREATED="1496821548296" MODIFIED="1496821553060">
<node TEXT="blockReceivedAndDeletedWithRetry" ID="ID_1401210968" CREATED="1496821557960" MODIFIED="1496826858525">
<font BOLD="false"/>
<node TEXT="reportReceivedDeletedBlocks" ID="ID_1209349125" CREATED="1496821575880" MODIFIED="1496821581116">
<node TEXT="whirlingLikeASufi (on rdbqueue modified)" ID="ID_1455680821" CREATED="1496821587568" MODIFIED="1496823581892">
<font BOLD="true"/>
</node>
<node TEXT="blockReport" ID="ID_1290109481" CREATED="1496821595992" MODIFIED="1496821607244">
<node TEXT="whirlingLikeASufi (on rdbqueue modified)" ID="ID_200989313" CREATED="1496821615888" MODIFIED="1496823577900">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="dn.blockReport" ID="ID_1107930294" CREATED="1496821842614" MODIFIED="1496821845354">
<node TEXT="BPServiceActor.blockReport" ID="ID_1626528892" CREATED="1496821852238" MODIFIED="1496821857626">
<node TEXT="blockReport" ID="ID_1129185922" CREATED="1496821866853" MODIFIED="1496821869586">
<node TEXT="whirlingLikeASufi (periodically)" ID="ID_1872149669" CREATED="1496821874533" MODIFIED="1496823533829">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="dn.commitBlockSynchronization" ID="ID_7172664" CREATED="1496821940121" MODIFIED="1496821946601">
<node TEXT="syncBlock x2" ID="ID_1626907820" CREATED="1496821974268" MODIFIED="1496821978393">
<node TEXT="recoverBlock" ID="ID_6765923" CREATED="1496821985165" MODIFIED="1496821987129">
<node TEXT="(Daemon)recoverBlocks" ID="ID_958099901" CREATED="1496822001540" MODIFIED="1496822027641">
<node TEXT="processCommandFromActive (DNA_RECOVERBLOCKS)" ID="ID_1228705586" CREATED="1496822040820" MODIFIED="1496822186776">
<node TEXT="..." ID="ID_982620003" CREATED="1496822073836" MODIFIED="1496822079244">
<node TEXT="whirlingLikeASufi" ID="ID_118368476" CREATED="1496822079247" MODIFIED="1496822087148">
<font BOLD="true"/>
</node>
</node>
<node TEXT="..." ID="ID_1396682362" CREATED="1496822120116" MODIFIED="1496822126076">
<node TEXT="BPServiceActor.offerService" ID="ID_667068224" CREATED="1496822126078" MODIFIED="1496822145411">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
<node ID="ID_812537261" CREATED="1496822429121" MODIFIED="1496827331465"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      (DNA_RECOVERBLOCKS) how is triggered <b>NN SIDE</b>
    </p>
  </body>
</html>
</richcontent>
<node TEXT="DatanodeManager.handleHeartBeat" ID="ID_1393233723" CREATED="1496822254860" MODIFIED="1496822453446">
<node TEXT="getLeaseRecoveryCommand" ID="ID_392606190" CREATED="1496822283386" MODIFIED="1496822290950">
<node TEXT="addBlockToBeRecovered" ID="ID_1118112174" CREATED="1496822315842" MODIFIED="1496822320678">
<node TEXT="initializeBlockRecovery" ID="ID_1797234538" CREATED="1496822325946" MODIFIED="1496822330094">
<node TEXT="internalReleaseLease" ID="ID_840073668" CREATED="1496822341346" MODIFIED="1496822346121">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="BPOfferService.notifyNamenodeX" POSITION="right" ID="ID_1664405580" CREATED="1496822742318" MODIFIED="1496833331430">
<edge COLOR="#00ffff"/>
<node TEXT="notifyNamenodeRecevied" ID="ID_1773197363" CREATED="1496822767366" MODIFIED="1496822773267">
<node TEXT="DataNode.notifyNamenodeReceivedBlock" ID="ID_1786538486" CREATED="1496822789734" MODIFIED="1496822819514">
<node TEXT="interDataNode.updateReplicaUnderRecovery" ID="ID_1241309531" CREATED="1496822827327" MODIFIED="1496822844549">
<font BOLD="true"/>
</node>
<node TEXT="DataXceiver.replaceBlock" ID="ID_1620722912" CREATED="1496822850990" MODIFIED="1496822875102">
<node TEXT="Balancer.replaceBlock" ID="ID_482317408" CREATED="1496822875104" MODIFIED="1496822921037">
<font BOLD="true"/>
</node>
<node TEXT="Receiver.opReplaceBlock" ID="ID_210786083" CREATED="1496822935293" MODIFIED="1496822940201">
<node TEXT="Balancer.replaceBlock" ID="ID_14642701" CREATED="1496822963477" MODIFIED="1496822971372">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="DataNode.closeBlock" ID="ID_1048977550" CREATED="1496823034524" MODIFIED="1496823038664">
<node TEXT="BlockReceiver.run" ID="ID_563190599" CREATED="1496823052892" MODIFIED="1496823056344">
<node TEXT="DataXceiver.writeBlock (datanode &amp;&amp; != pipeline_close_recovery)" ID="ID_679238464" CREATED="1496825923693" MODIFIED="1496826024033"/>
</node>
<node TEXT="DataXceiver.writeBlock (pipeline_close_recovery)|| isDatanode" ID="ID_246540607" CREATED="1496823069364" MODIFIED="1496823324230">
<node TEXT="DataNode.DataTransfer.run" ID="ID_1095044690" CREATED="1496823626927" MODIFIED="1496823633068">
<node TEXT="DataNode.transferBlock" ID="ID_1631991956" CREATED="1496825629223" MODIFIED="1496825633707">
<node TEXT="transferBlocks" ID="ID_1291966049" CREATED="1496825664759" MODIFIED="1496825667483">
<node TEXT="processCommandFromActive (DNA_TRANSFER)" ID="ID_1791889630" CREATED="1496825677463" MODIFIED="1496825698686">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="transferReplicaForPipelineRecovery" ID="ID_717590776" CREATED="1496825719670" MODIFIED="1496825726515">
<node TEXT="DataXceiver.transferBlock" ID="ID_895788913" CREATED="1496825733054" MODIFIED="1496825738538">
<node TEXT="DFSOutputStream.transfer" ID="ID_18645684" CREATED="1496825749102" MODIFIED="1496825758268">
<node TEXT="addDatanode2ExistingPipeline" ID="ID_1378564647" CREATED="1496825813685" MODIFIED="1496825825466">
<node TEXT="setupPipelineForAppendOrRecovery" ID="ID_1864865717" CREATED="1496825831573" MODIFIED="1496825839293">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="writeBlock (recursive)" ID="ID_456012829" CREATED="1496823673887" MODIFIED="1496823685331"/>
<node TEXT="createBlockOutputStream" ID="ID_61027116" CREATED="1496823685927" MODIFIED="1496823715971">
<node TEXT="setupPipelineForAppendOrRecovery" ID="ID_903576019" CREATED="1496824562080" MODIFIED="1496824703726">
<font BOLD="true"/>
</node>
<node TEXT="setupPipelineForSingleBlock" ID="ID_1548900922" CREATED="1496824615040" MODIFIED="1496824621403">
<node TEXT="DataStream.run (PIPELINE_SETUP_SINGLE_BLOCK)" ID="ID_592066807" CREATED="1496825150083" MODIFIED="1496825163987">
<font BOLD="true"/>
</node>
</node>
<node TEXT="nextBlockOutputStream" ID="ID_1094113831" CREATED="1496824632912" MODIFIED="1496825243442">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="notifyNamenodeReceivingBlock" ID="ID_453525852" CREATED="1496826060507" MODIFIED="1496826280758">
<node TEXT="DataNode.notifyNamenodeReceivingBlock" ID="ID_54853800" CREATED="1496826081715" MODIFIED="1496826093311">
<node TEXT="BlockReceiver()" ID="ID_45540122" CREATED="1496826106019" MODIFIED="1496826161127">
<node TEXT=" PIPELINE_SETUP_CREATE" ID="ID_494638186" CREATED="1496826162171" MODIFIED="1496826164687"/>
<node TEXT="PIPELINE_SETUP_APPEND" ID="ID_744328367" CREATED="1496826165563" MODIFIED="1496826179767"/>
<node TEXT="PIPELINE_SETUP_APPEND_RECOVERY" ID="ID_1740591246" CREATED="1496826180442" MODIFIED="1496826185775"/>
</node>
</node>
</node>
<node TEXT="notifyNamenodeDeletedBlock" ID="ID_1669168131" CREATED="1496826259906" MODIFIED="1496826348399">
<node TEXT="DataNode.notifyNamenodeDeletedBlock" ID="ID_257693538" CREATED="1496826357505" MODIFIED="1496826365045">
<node TEXT="ReplicaFileDeleteTask.run" ID="ID_358202980" CREATED="1496826397553" MODIFIED="1496826402173">
<node TEXT="deleteAsync" ID="ID_14188058" CREATED="1496826408432" MODIFIED="1496826413245">
<node TEXT="invalidate" ID="ID_187398559" CREATED="1496826420936" MODIFIED="1496826438140">
<node TEXT="processCommandFromActive (DNA_INVALIDATE)" ID="ID_1686348670" CREATED="1496826453280" MODIFIED="1496826480192">
<font BOLD="false"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="interDatanodeProtocol" POSITION="right" ID="ID_383127026" CREATED="1496833440920" MODIFIED="1496833446940">
<edge COLOR="#00ff00"/>
<node TEXT="initReplicaRecovery" ID="ID_85212907" CREATED="1496833506591" MODIFIED="1496833510836"/>
<node TEXT="updateReplicaUnderRecovery" ID="ID_1977862104" CREATED="1496833524383" MODIFIED="1496833529772"/>
</node>
<node TEXT="addReplica" POSITION="left" ID="ID_299658948" CREATED="1496831365056" MODIFIED="1496833276803">
<edge COLOR="#0000ff"/>
<node TEXT="DatanodeDescriptor.addBlock" ID="ID_1628315508" CREATED="1496831413736" MODIFIED="1496831422148">
<node TEXT="BlockManager.markBlockAsCorrupt" ID="ID_301919657" CREATED="1496831450551" MODIFIED="1496831462932">
<node TEXT="findAndMarkBlockAsCorrupt" ID="ID_1908171692" CREATED="1496831593350" MODIFIED="1496831603347">
<node TEXT="reportBadBlocks" ID="ID_1689370667" CREATED="1496831671302" MODIFIED="1496831680106">
<node TEXT="client/dn.reportBadBlocks" ID="ID_1527925561" CREATED="1496831684413" MODIFIED="1496831693901">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="processAndHandleReportedBlock" ID="ID_183345814" CREATED="1496831604286" MODIFIED="1496831661094">
<font BOLD="true"/>
</node>
<node TEXT="markBlockAsCorruptTx" ID="ID_1956939874" CREATED="1496831634174" MODIFIED="1496831638714">
<node TEXT="processFullReport" ID="ID_708984921" CREATED="1496831644430" MODIFIED="1496831653686">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="BlockManager.addStoredBlock" ID="ID_877582836" CREATED="1496831464383" MODIFIED="1496831478492">
<node TEXT="addStoredBlockUnderConstruction" ID="ID_1798710239" CREATED="1496831517007" MODIFIED="1496831521660">
<node TEXT="processAndHandleReportedBlock" ID="ID_1477476960" CREATED="1496831754581" MODIFIED="1496831794869">
<font BOLD="true"/>
</node>
<node TEXT="addStoredBlockUnderConstructionTx" ID="ID_1632312175" CREATED="1496831762317" MODIFIED="1496831785233">
<node TEXT="processFullReport" ID="ID_1973630386" CREATED="1496831789973" MODIFIED="1496831793901">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="processAndHandleReportedBlock" ID="ID_1835957438" CREATED="1496831523847" MODIFIED="1496831660270">
<font BOLD="true"/>
</node>
<node TEXT="addStoredBlockTx" ID="ID_544083653" CREATED="1496831538583" MODIFIED="1496831557859">
<node TEXT="processFullReport" ID="ID_1201523932" CREATED="1496831562863" MODIFIED="1496831654374">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="FSNamesystem.commitBlockSynchronization" ID="ID_104983642" CREATED="1496831491975" MODIFIED="1496831504287">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="removeReplica" POSITION="left" ID="ID_1204859362" CREATED="1496831891100" MODIFIED="1496833268083" HGAP="60" VSHIFT="40">
<edge COLOR="#ff0000"/>
<node TEXT="DatanodeDescriptor.removeBlock" ID="ID_5349352" CREATED="1496831897052" MODIFIED="1496831904008">
<node TEXT="BlocksMap.removeNode" ID="ID_162074627" CREATED="1496831909572" MODIFIED="1496831918616">
<node TEXT="BlockManager.removeStoredBlock" ID="ID_963267186" CREATED="1496832107802" MODIFIED="1496832113871">
<node TEXT="invalidateBlock" ID="ID_1875581339" CREATED="1496832123594" MODIFIED="1496832126687">
<node TEXT="markBlockAsCorrupt" ID="ID_382041215" CREATED="1496832250833" MODIFIED="1496832275185">
<font BOLD="true"/>
</node>
<node TEXT="invalidateCorrupReplicas" ID="ID_439498663" CREATED="1496832263609" MODIFIED="1496832268869">
<node TEXT="addStoredBlock" ID="ID_1154705316" CREATED="1496832284817" MODIFIED="1496832288625">
<font BOLD="true"/>
</node>
</node>
</node>
<node TEXT="processIncrementalBlockReport" ID="ID_1177192513" CREATED="1496832137242" MODIFIED="1496832295025">
<font BOLD="true"/>
</node>
<node TEXT="removeStoredBlockTx" ID="ID_1773899820" CREATED="1496832149770" MODIFIED="1496832155086">
<node TEXT="removeBlocksAssociatedTo" ID="ID_168082707" CREATED="1496832159962" MODIFIED="1496832164198">
<node TEXT="DatanodeManager.removeDatanode" ID="ID_1877477366" CREATED="1496832192985" MODIFIED="1496832213161">
<font BOLD="true"/>
<node TEXT="..." ID="ID_235924494" CREATED="1496832210009" MODIFIED="1496832219457">
<font BOLD="false"/>
</node>
</node>
</node>
<node TEXT="processFullReport" ID="ID_856741721" CREATED="1496832165850" MODIFIED="1496832182738">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="removeAllReplicas" POSITION="left" ID="ID_613766767" CREATED="1496832068090" MODIFIED="1496833263254">
<edge COLOR="#7c7c00"/>
<node TEXT="BlocksMap.removeBlock" ID="ID_1496930848" CREATED="1496921298908" MODIFIED="1496921313586">
<node TEXT="BlockManager.removeBlock" ID="ID_1293617354" CREATED="1496921319980" MODIFIED="1496921325793">
<node TEXT="FSNamesystem.removeBlocks" ID="ID_1972298432" CREATED="1496921476563" MODIFIED="1496921484607"/>
<node TEXT="FSNamesystem.removePathAndBlocks" ID="ID_191693346" CREATED="1496921493907" MODIFIED="1496921502119">
<node TEXT="unprotectedRenameTo x2" ID="ID_420128775" CREATED="1496921517075" MODIFIED="1496921540975"/>
<node TEXT="FSDirectory.delete" ID="ID_467403085" CREATED="1496921542187" MODIFIED="1496921550231">
<node TEXT="FSNamesystem.deleteInternal" ID="ID_1751867399" CREATED="1496921555579" MODIFIED="1496921565967">
<node TEXT="deleteInt" ID="ID_943986750" CREATED="1496921601482" MODIFIED="1496921605958">
<node TEXT="FSNamesystem.delete" ID="ID_1896695382" CREATED="1496921702625" MODIFIED="1496921707517">
<node TEXT="startFileInternal" ID="ID_1103821127" CREATED="1496921715873" MODIFIED="1496923161205">
<font BOLD="true"/>
</node>
<node TEXT="deleteWithTransaction" ID="ID_457792861" CREATED="1496921719345" MODIFIED="1496921755805">
<node TEXT="multiTransactionDeleteInternal x2" ID="ID_395437147" CREATED="1496921768889" MODIFIED="1496921788181">
<font BOLD="true"/>
</node>
<node TEXT="ErasureCodingManager.garbageCollect" ID="ID_880647709" CREATED="1496923032615" MODIFIED="1496923049899">
<node TEXT="ErasureCodingMontior" ID="ID_1920743074" CREATED="1496923089030" MODIFIED="1496923143986">
<font BOLD="true"/>
</node>
</node>
<node TEXT="ErasureCodingManager.checkRevoked" ID="ID_682373980" CREATED="1496923050798" MODIFIED="1496923065994">
<node TEXT="ErasureCodingMonitor" ID="ID_417475037" CREATED="1496923073294" MODIFIED="1496923147458">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="multiTransactionDeleteInternal" ID="ID_538826117" CREATED="1496921606498" MODIFIED="1496921619823">
<node TEXT="deleteTreeLevel x3" ID="ID_289828087" CREATED="1496921628834" MODIFIED="1496921640551">
<node TEXT="multiTransactionDeleteInternal" ID="ID_1774383978" CREATED="1496921650778" MODIFIED="1496921658438">
<node TEXT="multiTransactionDelete" ID="ID_610021474" CREATED="1496921666778" MODIFIED="1496921670870">
<node TEXT="client.delete" ID="ID_278359582" CREATED="1496921676666" MODIFIED="1496921679889">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="BlockManager.removeBlockFromMap" ID="ID_67067395" CREATED="1496921327636" MODIFIED="1496921343137">
<node TEXT="FSDirectory.unprotectedRemoveBlock" ID="ID_1587500571" CREATED="1496921353748" MODIFIED="1496921366641">
<node TEXT="FSDirectory.removeBlock" ID="ID_1903323219" CREATED="1496921406828" MODIFIED="1496921411369">
<node TEXT="FSNamesystem.abandonBlock" ID="ID_1895909204" CREATED="1496921417859" MODIFIED="1496921422400">
<node TEXT="client.abandonBlock" ID="ID_53307695" CREATED="1496921427211" MODIFIED="1496921459275">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
<node TEXT="FSNamesystem.commitBlockSynchronization" ID="ID_1985993932" CREATED="1496921367716" MODIFIED="1496921399917">
<font BOLD="true"/>
</node>
</node>
</node>
</node>
</node>
</map>
